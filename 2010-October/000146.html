<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [gpt-devel] Fwd:  Como implementar estruturas de controle
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/gpt-devel/2010-October/index.html" >
   <LINK REL="made" HREF="mailto:gpt-devel%40lists.berlios.de?Subject=Re%3A%20%5Bgpt-devel%5D%20Fwd%3A%20%20Como%20implementar%20estruturas%20de%20controle&In-Reply-To=%3CAANLkTimBKHwK7Hij-3rOJo8c5oKAqhSdAAQ4S9XLopTK%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000145.html">
   <LINK REL="Next"  HREF="000147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[gpt-devel] Fwd:  Como implementar estruturas de controle</H1>
    <B>Thiago Silva</B> 
    <A HREF="mailto:gpt-devel%40lists.berlios.de?Subject=Re%3A%20%5Bgpt-devel%5D%20Fwd%3A%20%20Como%20implementar%20estruturas%20de%20controle&In-Reply-To=%3CAANLkTimBKHwK7Hij-3rOJo8c5oKAqhSdAAQ4S9XLopTK%40mail.gmail.com%3E"
       TITLE="[gpt-devel] Fwd:  Como implementar estruturas de controle">tsilva at sourcecraft.info
       </A><BR>
    <I>Wed Oct 20 16:10:51 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000145.html">[gpt-devel] Fwd:  Como implementar estruturas de controle
</A></li>
        <LI>Next message: <A HREF="000147.html">[gpt-devel] Fwd: Como implementar estruturas de controle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#146">[ date ]</a>
              <a href="thread.html#146">[ thread ]</a>
              <a href="subject.html#146">[ subject ]</a>
              <a href="author.html#146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>---------- Forwarded message ----------
From: Thiago Silva &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpt-devel">tsilva at sourcecraft.info</A>&gt;
Date: 2010/10/20
Subject: Re: [gpt-devel] Como implementar estruturas de controle
To: Alex Garzao &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpt-devel">alexgarzaol at gmail.com</A>&gt;


2010/10/19 Alex Garzao &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpt-devel">alexgarzaol at gmail.com</A>&gt;:
&gt;<i> Boa noite :-)
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; Acho que &#233; este o ponto sim. Para ler o c&#243;digo acima (meu exemplo) j&#225; &#233;
</I>&gt;&gt;<i> &gt; tortuoso (pelo n&#250;mero de closures). Imagina um exemplo mais real, com
</I>&gt;&gt;<i> &gt; v&#225;rias
</I>&gt;&gt;<i> &gt; fun&#231;&#245;es com in&#250;meros blocos de c&#243;digo?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Agora eis que pergunto: qual a import&#226;ncia que vc atribui para uma
</I>&gt;&gt;<i> leitura mais &quot;fluente&quot; e edi&#231;&#227;o de gptassembly?
</I>&gt;<i>
</I>&gt;<i> Pensei em lhe fazer a mesma pergunta :-)
</I>&gt;<i> Bom, se a id&#233;ia &#233; que os usu&#225;rios consigam ver o c&#243;digo em gptassembly para
</I>&gt;<i> entender como as coisas funcionam, ent&#227;o acredito que ela deve ser de &quot;f&#225;cil
</I>&gt;<i> leitura&quot;, dentro das possibilidades claro (acredito que milagre n&#227;o &#233; bem a
</I>&gt;<i> nossa praia hehehe). Se ela n&#227;o deve ser para usu&#225;rios, bom, a&#237; questiono o
</I>&gt;<i> porque de termos a possibilidade de programar neste assembly.
</I>
pois &#233;. Em termos gerais, pelo menos o gptassembly tem servido para
conversarmos sobre o modelo de execu&#231;&#227;o. Acho que ele vai ser &#250;til tbm
na hora de tratar do formato bin&#225;rio...

Mas realmente eu n&#227;o acho que vamos (ou que usu&#225;rios ir&#227;o) programar
neste assembly.


&gt;&gt;<i> Eu vejo alguns aspectos nesta quest&#227;o. Eu acho que o gptassembly deve
</I>&gt;&gt;<i> ser &quot;entend&#237;vel&quot;.
</I>&gt;<i>
</I>&gt;<i> Isso. Se &#233; para facilitar para que entendam como as coisas funcionam
</I>&gt;<i> internamente, acredito que temos que investir mais entende?
</I>
deixa eu s&#243; esclarecer o que eu quis dizer hehe....pensei em
&quot;entendivel&quot; como algo diferente de &quot;legivel&quot;. Entendivel no sentido
de n&#227;o haver coisas obscuras e magia negra...de bater o olho e saber o
que aquele mnemonico ou sintaxe faz. Legivel no sentido de vc se
sentir confort&#225;vel lendo o c&#243;digo e entendendo sua estrutura, seu
algoritmo. Eu me contento muito bem com &quot;entendivel&quot;.

&gt;&gt;<i> &gt;&gt; Sei que h&#225; formas de gerar um c&#243;digo mais tradicional com condicionais
</I>&gt;&gt;<i> &gt;&gt; e jumps (sei que isso &#233; feito como otimiza&#231;&#227;o em m&#225;quinas OO puras)
</I>&gt;&gt;<i> &gt;&gt; sem violar o modelo, mas n&#227;o &#233; algo que eu investiguei muito...
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Eu nunca investiguei m&#225;quinas OO puras. Ok, sei que voc&#234; mandou at&#233; o
</I>&gt;&gt;<i> &gt; link
</I>&gt;&gt;<i> &gt; de um livro, mas como eu ainda n&#227;o li, lhe pergunto: voc&#234; sabe dar mais
</I>&gt;&gt;<i> &gt; informa&#231;&#245;es sobre como estas m&#225;quinas implementam estes recursos? Como
</I>&gt;&gt;<i> &gt; seria
</I>&gt;&gt;<i> &gt; o assembly de uma VM de smalltalk, por exemplo?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> O assembly do smalltalk &#233; bem parecido com estamos discutindo aqui.
</I>&gt;&gt;<i> Ela s&#243; tem opcodes de push, pop, envio de mensagens e retorno, mais
</I>&gt;&gt;<i> opcodes de popAndJump que s&#243; checam pelos valores &quot;true&quot; e &quot;false&quot; na
</I>&gt;&gt;<i> pilha.
</I>&gt;<i>
</I>&gt;<i> Interessante...
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Com otimiza&#231;&#227;o &#233; outra hist&#243;ria pois em tempo de execu&#231;&#227;o se faz
</I>&gt;&gt;<i> inlining das fun&#231;&#245;es, criando blocos de c&#243;digo para casos
</I>&gt;&gt;<i> particulares, compilando-as novamente e, em seguida, rodando um JIT.
</I>&gt;&gt;<i> Ent&#227;o, nas particularidades, certamente podemos utilizar opcodes mais
</I>&gt;&gt;<i> especificos, mas sempre h&#225; o fallback para o envio de mensagens. Acho
</I>&gt;&gt;<i> que n&#227;o h&#225; nada a ganhar em termos de simplicidade fazendo isso.
</I>&gt;<i>
</I>&gt;<i> Otimiza&#231;&#227;o n&#227;o &#233; algo que nos interessa atualmente, creio eu.
</I>
isso.

&gt;&gt;<i>
</I>&gt;&gt;<i> O que mais me preocupa, neste momento, &#233; o encapsulamento. Se vc tiver
</I>&gt;&gt;<i> id&#233;ias para opcodes que n&#227;o violem o encapsulamento, pode sugerir.
</I>&gt;<i>
</I>&gt;<i> Para meu entendimento, me esclarece uma coisa. Naquele exemplo &quot;tradicional&quot;
</I>&gt;<i> de la&#231;o, porque os opcodes violam o encapsulamento?
</I>
No caso, opcodes como &quot;meoi&quot;.

Dando um passo pra traz, eu disse que viola supondo que este opcode &#233;
respons&#225;vel por &quot;destilar&quot; os inteiros dos objetos na pilha e realizar
a compara&#231;&#227;o. Se for o caso, ele viola o encapsulamento, porque assume
que os argumentos s&#227;o objetos que representam inteiros e possui
conhecimento sobre a estrutura destes objetos -- para saber como
acessar estes inteiros. O encapsulamento &#233; preservado se todas as
opera&#231;&#245;es s&#227;o feitas via protocolo/interface e se as informa&#231;&#245;es sobre
a estrutura do objeto e sobre o algoritmo de suas opera&#231;&#245;es somente o
pr&#243;prio objeto sabe.

Isso vendo &quot;por baixo&quot;. Vendo &quot;por cima&quot;, ficar&#225; bastante complicado
compilar um c&#243;digo em alto n&#237;vel que gere o opcode &quot;meoi&quot; sem
informa&#231;&#227;o de tipo. Por exemplo

x &lt;= y

o compilador precisa saber que os objetos envolvidos na mensagem &quot;&lt;=&quot;
(x e y) s&#227;o inteiros e obedecem a estrutura que &quot;meoi&quot; assume saber
operar sobre. Se eles n&#227;o forem inteiros, ent&#227;o tal express&#227;o deve
gerar um &quot;invoca&quot; (provavelmente equivalente a x.&lt;=(y)). Caso
contr&#225;rio, &quot;&lt;=&quot; ser&#225; algo espec&#237;fico para inteiros e n&#227;o ser&#225; v&#225;lido
para objetos arbitr&#225;rios para as quais esta mensagem faz sentido (como
outras representa&#231;&#245;es num&#233;ricas que n&#227;o s&#227;o inteiros de 32bits, por
exemplo, ou outras grandezas).


&gt;<i> De qualquer forma, a minha proposta n&#227;o &#233; abandonarmos as id&#233;ias propostas,
</I>&gt;<i> mas sim investir mais nelas para que o gptassembly fique mais &quot;alto n&#237;vel&quot;.
</I>&gt;<i> Lembra quando eu queria colocar opcodes para &quot;adicionar&quot; os m&#233;todos aos
</I>&gt;<i> objetos, e voc&#234; sugeriu deixar isso expl&#237;cito na sintaxe com algo como
</I>&gt;<i> &quot;.fun&#231;&#227;o nome_objeto:nome_fun&#231;&#227;o&quot;? &#201; neste sentido que devemos investir, na
</I>&gt;<i> minha opini&#227;o.
</I>&gt;<i> Vou tentar rever o exemplo gerado a partir do G-Portugol abaixo:
</I>&gt;<i> fun&#231;&#227;o principal
</I>&gt;<i> &#160;&#160;&#160; para cada X de 1 at&#233; 10 fa&#231;a
</I>&gt;<i> &#160;&#160;&#160;&#160;&#160;&#160;&#160; se X &lt;= 5 ent&#227;o
</I>&gt;<i> &#160; &#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160; imprima(X, &quot;eh &lt;= 5&quot;);
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;sen&#227;o
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160; &#160; &#160;imprima(X, &quot;eh &gt;= 6&quot;);
</I>&gt;<i> &#160;&#160;&#160;&#160;&#160;&#160;&#160; fim
</I>&gt;<i> &#160;&#160;&#160; fim
</I>&gt;<i> fim
</I>&gt;<i>
</I>&gt;<i> Equivalente em GptAssembly, tentando colocar as fun&#231;&#245;es &quot;an&#244;nimas&quot; digamos
</I>&gt;<i> assim &quot;embutidas&quot; na fun&#231;&#227;o original:
</I>&gt;<i> .fun&#231;&#227;o principal
</I>&gt;<i> &#160;&#160; &#160;.vari&#225;vel X
</I>&gt;<i> &#160;&#160; &#160;carvar X
</I>&gt;<i> &#160;&#160; &#160;carconst 1
</I>&gt;<i> &#160;&#160; &#160;carconst 10
</I>&gt;<i> &#160;&#160; &#160;carfun&#231;&#227;o (X) // era corpo_for
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;carpar X
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;carconst 5
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;carfun&#231;&#227;o (X) // era se_verdadeiro
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160; &#160; &#160;carpar X
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;&#160;&#160; &#160;carconst &quot;eh &lt;= 5&quot;
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;&#160;&#160; &#160;carconst 2
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;&#160;&#160; &#160;invoca imprima
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;fimcarfun&#231;&#227;o
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;carfun&#231;&#227;o (X) // era se_falso
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160; &#160; &#160;carpar X
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;&#160;&#160; &#160;carconst &quot;eh &gt;= 6&quot;
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;&#160;&#160; &#160;carconst 2
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;&#160;&#160; &#160;invoca imprima
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;fimcarfun&#231;&#227;o
</I>&gt;<i> &#160;&#160; &#160; &#160; &#160;meoi
</I>&gt;<i> &#160;&#160; &#160;fimcarfun&#231;&#227;o
</I>&gt;<i> &#160;&#160; &#160;invoca at&#233;
</I>&gt;<i> .fim_fun&#231;&#227;o
</I>&gt;<i> Ok, acho que n&#227;o ficou o &quot;&#243;&quot; do &quot;bor&#243;&quot;, mas vamos tentando evoluir na id&#233;ia
</I>&gt;<i> :-)
</I>
uai, gostei muito!! hehe :)

ficou um assembly bem altonivelzinho, hehehe

[]'s

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000145.html">[gpt-devel] Fwd:  Como implementar estruturas de controle
</A></li>
	<LI>Next message: <A HREF="000147.html">[gpt-devel] Fwd: Como implementar estruturas de controle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#146">[ date ]</a>
              <a href="thread.html#146">[ thread ]</a>
              <a href="subject.html#146">[ subject ]</a>
              <a href="author.html#146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/gpt-devel">More information about the Gpt-devel
mailing list</a><br>
</body></html>
